"use strict";(self.webpackChunkelectrichq=self.webpackChunkelectrichq||[]).push([[283],{5283:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var c=n(4165),r=n(5861),a=n(885),i=n(7313),s=n(6123),o=n.n(s),l=n(4696),u=n(6117),d=n(7114),p=n.n(d),h=function(e,t,n,c){return p().fire({icon:e,title:t,text:n,timer:3e3,showConfirmButton:!1}).then((function(e){c()}))},f="Stripe_container__bO9Q8",m="Stripe_highlighted__ViBRC",k="Stripe_title__msbud",b="Stripe_productsContainer__G2SNT",x="Stripe_productCard__lHCTa",v="Stripe_genericButton__rT8+m",g="Stripe_buttonPanel__x-qaj",S=n(6417),_=function(){var e=(0,l.useStripe)(),t=(0,l.useElements)(),n=function(){var n=(0,r.Z)((0,c.Z)().mark((function n(r){var a,i;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.next=3,e.confirmPayment({elements:t,redirect:"if_required"});case 3:a=n.sent,i=a.error,a.paymentIntent,i?(console.log(i),c="error",s="Error al procesar el pago",o=i.message,p().fire({icon:c,title:s,text:o,timer:3e3,showConfirmButton:!1})):h("success","\xa1Pago completado!","El pago ha sido procesado con \xe9xito",(function(){return window.location.replace("/")}));case 7:case"end":return n.stop()}var c,s,o}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("form",{children:[(0,S.jsx)(l.PaymentElement,{}),(0,S.jsx)("div",{className:g,children:(0,S.jsx)("button",{className:v,onClick:n,children:"Pagar"})})]})})},j=function(e){var t=e.hidden,n=e.children;return t?null:n},y=function(e){var t=e.product,n=e.setCurrentProduct;return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{className:x,onClick:function(){return n(t.id)},children:[(0,S.jsx)("p",{children:t.name}),(0,S.jsx)("p",{children:t.price})]})})},C=n(3144),E=n(5671),w=n(6573),Z=(0,C.Z)((function e(){(0,E.Z)(this,e),this.makeGetRequest=function(e){var t=e.url,n=e.config,c=e.callbackSuccess,r=e.callbackError;w.Z.get(t,n).then(c).catch(r)},this.makePostRequest=function(e){var t=e.url,n=e.body,c=e.config,r=e.callbackSuccess,a=e.callbackError;w.Z.post(t,n,c).then(r).catch(a)},this.makePutRequest=function(e){var t=e.url,n=e.body,c=e.config,r=e.callbackSuccess,a=e.callbackError;w.Z.put(t,n,c).then(r).catch(a)},this.makeDeleteRequest=function(e){var t=e.url,n=e.config,c=e.callbackSuccess,r=e.callbackError;w.Z.delete(t,n).then(c).catch(r)}})),P=n(5430),q="http://localhost:8080",R="/api/payments",I=(0,C.Z)((function e(){var t=this;(0,E.Z)(this,e),this.createPaymentIntent=function(e){var n=e.productId,c=e.callbackSuccess,r=e.callbackError;console.log("endpoint",R),console.log("SERVER",q);var a={url:"https://ehqbackend-production.up.railway.app/api/payment-intents?id=".concat(n),callbackSuccess:c,callbackError:r};t.client.makePostRequest(a)},this.pay=function(e){var n=e.body,c=e.callbackSuccess,r=e.callbackError,a={url:"".concat(q).concat(R,"/checkout"),body:n,config:{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0},callbackSuccess:c,callbackError:r};t.client.makePostRequest(a)},this.client=new Z})),N=(0,u.J)("pk_test_51NCCXeHMI31FK164AYXShSTW62RgAeLmuO2pi0rkMbL6GHntvlhkHAXncK4wH7XliAlcanb8msw5W1enu5MXIWWx00Qb8scHfR"),A=function(){var e=(0,i.useContext)(P.A).orderID,t=(0,i.useState)(null),n=(0,a.Z)(t,2),s=n[0],u=n[1],d=(0,i.useState)(null),p=(0,a.Z)(d,2),h=p[0],x=p[1];(0,i.useEffect)((function(){var e=function(){var e=(0,r.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(s),(new I).createPaymentIntent({productId:s,callbackSuccess:v,callbackError:g});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s&&e()}),[s]);var v=function(e){x(e.data.payload.client_secret)},g=function(e){console.log(e)};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:f,children:[console.log("OrderID ",e),(0,S.jsxs)("h1",{className:k,children:["Stripe, about to pay ",e.totalPrice," USD"]}),(0,S.jsx)("h1",{})]}),(0,S.jsxs)("div",{className:o()([f,m]),children:[(0,S.jsx)(j,{hidden:s,children:(0,S.jsx)("div",{className:b,children:[{id:1,name:"papas",price:1e3},{id:2,name:"queso",price:500},{id:3,name:"hamburguesa",price:1500},{id:4,name:"soda",price:1e3},{id:5,name:"golosinas",price:800}].map((function(e){return(0,S.jsx)(y,{product:e,setCurrentProduct:u},e.id)}))})}),(0,S.jsx)(j,{hidden:!h||!N,children:(0,S.jsx)(l.Elements,{stripe:N,options:{clientSecret:h},children:(0,S.jsx)(_,{})})})]})]})}}}]);